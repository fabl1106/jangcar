{% extends 'base.html' %}
{% block head %}

<!--<link rel="stylesheet" href="/css/jquery-ui.min.css">-->

<!--<script type='text/javascript' src='//code.jquery.com/jquery-1.8.3.js'></script>-->
<!--<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>-->
<script
  src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
  integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30="
  crossorigin="anonymous"></script>
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/css/bootstrap-datepicker3.min.css">
<script type='text/javascript'
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/js/bootstrap-datepicker.min.js"></script>
<!--<script src="/js/bootstrap-datepicker.kr.js" charset="UTF-8"></script>-->


<script type='text/javascript'>
    // $(function () {
    //     $('.input-group.date').datepicker({
    //         calendarWeeks: false,
    //         todayHighlight: true,
    //         autoclose: true,
    //         format: "yyyy-mm-dd",
    //         language: "kr",
    //         defalutDate: new Date()
    //     });
    // });


    var activeDeparture;
    var activeArrival;
    var date;

    function applyInfo() {
        $('#departure-label').text(activeDeparture);
        $('#departure_key_input').val(activeDeparture);
        $('#arrival-label').text(activeArrival);
        $('#arrive_key_input').val(activeArrival);

        if (date) {
            $('#date').text((date.getFullYear())+'년 ' + (date.getMonth() + 1) + '월 ' + date.getDate() + '일');
            $('#date_key_input').val($.datepicker.formatDate('yy-mm-dd', date));
        }
    }

    function launchModal(option) {

        $('.place-list-item').off('click').click(function () {
            if (option == 'departure') {
                activeDeparture = $(this).data('place');
            } else if (option == 'arrival') {
                activeArrival = $(this).data('place');
            }
            if ($('#places-modal').is(':visible')) {
                $('#places-modal').modal('hide');
            }
            applyInfo();
        })

        if (option == 'departure') {
            $('#places-modal .modal-title').text('출발지')
        } else if (option == 'arrival') {
            $('#places-modal .modal-title').text('도착지')
        }

        $('#places-modal').modal({
            show: true
        });
    }

     function launchDatePickerModal() {
            $('#datepicker').datepicker();
            $('#date-modal').modal({
                show: true
            });
    }

    function selectDateModal() {
            date = new Date($('#datepicker').datepicker('getFormattedDate'));
            console.log(date);
            $('#date-modal').modal('hide');
            applyInfo();
        }


</script>

{% endblock %}
{% block css %}

.main-button {
background: #ffffff;
padding: 20px 0px;
text-align: center;
width: 100%;
height: 70px;
max-width: 620px;
border-radius: 10px;
display: inline-block;
<!--margin: 0px 10px;-->
margin: auto;
transition: background 0.5s;
}

#left-check:hover, #right-check:hover, {
    background-color: #5672ff;
    cursor:pointer;

}

.check {
background: #ffffff;
padding: 20px 0px;
text-align: center;
width: 100px;
height: 90px;
border-radius: 10px;
display: inline-block;
transition: background 0.5s;
}

#left-check {
margin-left:22px;
margin-right:5px;
}

#right-check {
margin-left:5px;
margin-right:22px;
}

#submit {
background: #5672ff;
padding: 20px 0px;
text-align: center;
width: 100%;
max-width: 620px;
height: 70px;
border-radius: 10px;
display: inline-block;
<!--margin: 0px 10px;-->
margin: auto;
transition: background 0.5s;
}


{% endblock %}

{% block content %}

<form action="{% url 'drive:list' %}" method="POST" id="main-form">
    {% csrf_token %}

    <div class="row">
        <div class="places-card col check" id="left-check" onclick="launchModal('departure')">
            <span>출발지</span>
            <h3 id="departure-label">--</h3>
            <input type="hidden" name="departure_key" id="departure_key_input" />
        </div>
        <div class="places-mid-button align-middle">
            <i class="fas fa-arrows-alt-h"></i>
        </div>
        <div class="places-card col check" id="right-check" onclick="launchModal('arrival')">
            <span>도착지</span>
            <h3 id="arrival-label">--</h3>
            <input type="hidden" name="arrive_key" id="arrive_key_input"  />
        </div>

    </div>
    <br>
    <div class="row">
        <div class="col">
            <div class="main-button">
                <div class="time-card" onclick="launchDatePickerModal()">
                    <span id="infolabel">출발 날짜</span>
                    <h5 id="date">--</h5>
<!--                    <input type="hidden" id="date_key_input" name="date_key" />-->
                </div>
<!--                출발날짜-->
<!--                <div class="input-group date" data-provide="datepicker">-->
<!--                    <input type="text" class="form-control" name="date_key">-->
<!--                    <div class="input-group-addon">-->
<!--                        <span class="glyphicon glyphicon-th"></span>-->
<!--                    </div>-->
<!--                    &lt;!&ndash;                    <input type="text" class="form-control" name="date_key"><span class="input-group-addon"></span>&ndash;&gt;-->
<!--                </div>-->
            </div>

        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <input type="submit" id="submit" class="btn btn-primary btn-lg" value="조회하기">
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="date-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">출발 날짜</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="datepicker" style="width:400px;"></div>
                    <input type="hidden" id="date_key_input" name="date_key">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" onclick="selectDateModal()">선택</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="places-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">지역 선택하기</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="list-group">
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="서울">서울</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="경기">경기</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="인천">인천</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="강원">강원</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="대전">대전</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="충남">충남</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="충북">충북</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="광주">광주</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="전남">전남</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="전북">전북</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="부산">부산</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="대구">대구</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="경남">경남</a>
                        <a href="#" class="list-group-item list-group-item-action place-list-item"
                           data-place="경북">경북</a>
                    </div>
                </div>
                <!-- <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary">선택</button>
                </div> -->
            </div>
        </div>
    </div>
</form>

{% endblock %}
